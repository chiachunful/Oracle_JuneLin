  CREATE TABLE "ADJUSTMENT_REPORTING" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"SOURCE" VARCHAR2(255), 
	"STATUS" VARCHAR2(50), 
	"ASSIGN_TO" VARCHAR2(50), 
	"EXCEPTIONAL_MOVE_CATEGORY" VARCHAR2(50), 
	"REPORT_DATE" DATE, 
	"COUNTRY__OCE_" VARCHAR2(50), 
	"CUSTOMER_NAME" VARCHAR2(255), 
	"DEAL_ID" VARCHAR2(50) NOT NULL ENABLE, 
	"NS_ESTIMATE_NUM_" VARCHAR2(500), 
	"SPM_OM#" VARCHAR2(500), 
	"INVOICE_NUM_" VARCHAR2(200), 
	"ADJUSTMENT_AMT" NUMBER, 
	"ORIGINAL_INVOICE_AMOUNT" NUMBER, 
	"PAYMENT_DISCOUNT" NUMBER, 
	"PAYMENT_APPLIED_TO_INVOICE" NUMBER, 
	"GL_DATE_FOR_ADJUSTMENT" DATE, 
	"ADJUSTMENT_TYPE" VARCHAR2(50), 
	"TRADE_AR" NUMBER, 
	"UNBILLED" NUMBER, 
	"AR_AP_NETTING" NUMBER, 
	"OFD_CLD_120604" NUMBER, 
	"OFD_WH_120804" NUMBER, 
	"OFD_WHV2_XM232" NUMBER, 
	"OFD_WHV2_XM297" NUMBER, 
	"OFD_CLD_14745" NUMBER, 
	"OFD_WH_14746" NUMBER, 
	"OFD_WHV2_19846" NUMBER, 
	"OFD_WHV2_19848" NUMBER, 
	"MOVEMENT_TYPE" VARCHAR2(50), 
	"COMMENTS" VARCHAR2(4000), 
	"OFS_PAYMENT_POSTING" VARCHAR2(50), 
	"ASSIGNEE" VARCHAR2(50), 
	"PAYMENT_SOURCE" VARCHAR2(50), 
	"DEAL_TYPE" VARCHAR2(50), 
	"OTHER_ADJUSTMENT" NUMBER, 
	"ORDER_NUMBER" VARCHAR2(500), 
	"OCE" VARCHAR2(255), 
	"CREATED" TIMESTAMP (6), 
	"CREATED_BY" VARCHAR2(255), 
	"UPDATED" TIMESTAMP (6), 
	"UPDATED_BY" VARCHAR2(255), 
	"CHANGE_EVENT_TYPE" VARCHAR2(50), 
	"FUNDING_MODEL" VARCHAR2(50), 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 CONSTRAINT "CHK_SOURCE_STATUS" CHECK (NOT (source = 'NetSuite' AND status = 'Exceptional move')) DISABLE, 
	 CONSTRAINT "OMOVEDEALCOMBINATION" CHECK (
    (DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND MOVEMENT_TYPE NOT IN ('7.05 Auto Reversal'))
    OR 
    ((DEAL_TYPE = '7.05 Exception' OR DEAL_TYPE = '7.05 Exception - Indirect') AND MOVEMENT_TYPE NOT IN ('Move AR to GL', 'Move AR from GL'))
    OR
    (source = 'Oracle' AND DEAL_TYPE = 'Warehouse V2' AND MOVEMENT_TYPE NOT IN ('7.05 Auto Reversal'))
) DISABLE, 
	 CONSTRAINT "REPORT_DATE_MANDATORY" CHECK (
    status <> 'Standard' OR (status = 'Standard' AND report_date IS NOT NULL)
) DISABLE, 
	 CONSTRAINT "NSMOVEDEALCOMBINATION" CHECK (
    (source = 'NetSuite' AND DEAL_TYPE = 'Upfront' AND MOVEMENT_TYPE NOT IN ('Initial setup WHv2', 'Payment JE reclass'))
) DISABLE
   ) ;

  CREATE OR REPLACE EDITIONABLE TRIGGER "AdjRep_TRIGGER" 
BEFORE INSERT or update ON ADJUSTMENT_REPORTING
FOR EACH ROW
BEGIN
    
------CREATE TIMESTAMP --
 
    IF INSERTING THEN
      :NEW.CREATED := TRUNC(SYSTIMESTAMP, 'MI');
      :NEW.CREATED_BY := APEX_APPLICATION.g_user;
      :NEW.UPDATED := NULL;
      :NEW.UPDATED_BY := NULL;
    ELSIF updating then
      :NEW.UPDATED := TRUNC(SYSTIMESTAMP, 'MI');
      :NEW.UPDATED_BY := APEX_APPLICATION.g_user;
    End IF;

----INSERT AUTO CALCULATION FOR INITIAL MOVEMENT
    IF :NEW.MOVEMENT_TYPE = 'Initial movement' AND  :NEW.SOURCE = 'NetSuite' THEN
      :NEW.ADJUSTMENT_AMT := NVL(:NEW.ORIGINAL_INVOICE_AMOUNT, 0) - NVL(:NEW.PAYMENT_DISCOUNT, 0) - NVL(:NEW.PAYMENT_APPLIED_TO_INVOICE, 0) - NVL(:NEW.OTHER_ADJUSTMENT, 0);  
    END IF;

    IF :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.SOURCE = 'Oracle' AND :NEW.DEAL_TYPE IN ('Upfront billing / 7.05 Standard', 'Warehouse V2') THEN
      :NEW.ADJUSTMENT_AMT := NVL(:NEW.ORIGINAL_INVOICE_AMOUNT, 0) - NVL(:NEW.PAYMENT_DISCOUNT, 0) - NVL(:NEW.PAYMENT_APPLIED_TO_INVOICE, 0) - NVL(:NEW.OTHER_ADJUSTMENT, 0);    
    END IF;

----LOCK UP COLUMNS - ORIGINAL INVOICE AMOUNT, PAYMENT DISCOUNT, OTHER ADJUSTMENT, PAYMENT APPLIED TO INVOICE BASED ON SOURCE/MOVEMENT TYPE----
    IF :NEW.SOURCE = 'Oracle' THEN
      IF :NEW.MOVEMENT_TYPE IN ('7.05 Auto Reversal','Move AR to GL', 'Move AR from GL', 'Adjustment', 'Initial setup WHv2') THEN
        :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
        :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
        :NEW.PAYMENT_DISCOUNT := Null;
        :NEW.OTHER_ADJUSTMENT := Null;
      ELSIF :NEW.MOVEMENT_TYPE = 'Payment application' THEN
        :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
        :NEW.PAYMENT_DISCOUNT := Null;
        :NEW.OTHER_ADJUSTMENT := Null;
      ELSIF :NEW.MOVEMENT_TYPE = 'Initial movement' AND (:NEW.DEAL_TYPE = '7.05 Exception' OR :NEW.DEAL_TYPE = '7.05 Exception - Indirect') THEN
        :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
        :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
        :NEW.PAYMENT_DISCOUNT := Null;
        :NEW.OTHER_ADJUSTMENT := Null;
      END IF;
    ELSIF :NEW.SOURCE = 'NetSuite' THEN
      IF :NEW.MOVEMENT_TYPE IN ('Move AR to GL', 'Move AR from GL', 'Payment JE reclass', 'Initial setup WHv2') THEN
        :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
        :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
        :NEW.PAYMENT_DISCOUNT := Null;
        :NEW.OTHER_ADJUSTMENT := Null;
      ELSIF :NEW.MOVEMENT_TYPE = 'Apply to GL' THEN
        :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
        :NEW.PAYMENT_DISCOUNT := Null;
        :NEW.OTHER_ADJUSTMENT := Null;
      END IF;    
    END IF;
        
-----NetSuite Conditions FOR ACCT MOVEMENT
    IF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
     :NEW.ADJUSTMENT_TYPE := 'CM';
     :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_CLD_14745 := :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_WH_14746 := Null;
     :NEW.OFD_WHV2_19846 := Null;
     :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
     :NEW.ADJUSTMENT_TYPE := 'CM';
     :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_CLD_14745 := Null;
     :NEW.OFD_WH_14746 := :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_WHV2_19846 := Null;
     :NEW.OFD_WHV2_19848 := Null;
    ---condition for Warehouse V2
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
     :NEW.ADJUSTMENT_TYPE := 'CM';
     :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_CLD_14745 := Null;
     :NEW.OFD_WH_14746 := Null;
     :NEW.OFD_WHV2_19846 := Null;
     :NEW.OFD_WHV2_19848 := :NEW.ADJUSTMENT_AMT;

    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Initial setup WHv2' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
     :NEW.ADJUSTMENT_TYPE := 'JE';
     :NEW.TRADE_AR := Null;
     :NEW.OFD_CLD_14745 := Null;
     :NEW.OFD_WH_14746 := Null;
     :NEW.OFD_WHV2_19846 := :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_WHV2_19848 := - :NEW.ADJUSTMENT_AMT;

    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Payment JE reclass' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
     :NEW.ADJUSTMENT_TYPE := 'JE';
     :NEW.TRADE_AR := Null;
     :NEW.OFD_CLD_14745 := Null;
     :NEW.OFD_WH_14746 := Null;
     :NEW.OFD_WHV2_19846 := - :NEW.ADJUSTMENT_AMT;
     :NEW.OFD_WHV2_19848 := :NEW.ADJUSTMENT_AMT;
    ------
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Apply to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'Application';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ORIGINAL_INVOICE_AMOUNT := Null;
      :NEW.PAYMENT_DISCOUNT := Null;
      :NEW.OTHER_ADJUSTMENT := Null;
      :NEW.TRADE_AR := Null;
      :NEW.OFD_CLD_14745 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Apply to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'Application';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := Null;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Apply to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
      :NEW.ADJUSTMENT_TYPE := 'Application';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := Null;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WHV2_19848 := Null;

    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'CM';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'CM';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
      :NEW.ADJUSTMENT_TYPE := 'CM';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := :NEW.ADJUSTMENT_AMT;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'Manual invoice';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Upfront' THEN
      :NEW.ADJUSTMENT_TYPE := 'Manual invoice';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WHV2_19846 := Null;
      :NEW.OFD_WHV2_19848 := Null;
    ELSIF :NEW.SOURCE = 'NetSuite' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN
      :NEW.ADJUSTMENT_TYPE := 'Manual invoice';
      :NEW.PAYMENT_APPLIED_TO_INVOICE := Null;
      :NEW.ORIGINAL_INVOICE_AMOUNT:= Null;
      :NEW.PAYMENT_DISCOUNT:= Null;
      :NEW.OTHER_ADJUSTMENT:= Null;
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_CLD_14745 := Null;
      :NEW.OFD_WH_14746 := Null;
      :NEW.OFD_WHV2_19846 := - :NEW.ADJUSTMENT_AMT;
      :NEW.OFD_WHV2_19848 := Null;
    END IF;

-----Oracle Conditions FOR ACCT MOVEMENT
--INITIAL MOVEMENT
    IF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = '7.05 Exception' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := - :NEW.ADJUSTMENT_AMT;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = '7.05 Exception' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := - :NEW.ADJUSTMENT_AMT;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = '7.05 Exception - Indirect' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_CLD_120604" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = '7.05 Exception - Indirect' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;  
    
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial movement' AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN 
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := :NEW.ADJUSTMENT_AMT; 
    
    --INITIAL SETUP WHV2

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Initial setup WHv2' AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN 
      :NEW.ADJUSTMENT_TYPE := 'JE';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM297" := - :NEW.ADJUSTMENT_AMT;   
    
    --AUTO REVERSAL
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = '7.05 Auto Reversal' AND :NEW.DEAL_TYPE = '7.05 Exception' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := :NEW.ADJUSTMENT_AMT;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := -:NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF  :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = '7.05 Auto Reversal' AND :NEW.DEAL_TYPE = '7.05 Exception' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := :NEW.ADJUSTMENT_AMT;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := -:NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF  :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = '7.05 Auto Reversal' AND :NEW.DEAL_TYPE = '7.05 Exception - Indirect' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_CLD_120604" := -:NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF  :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = '7.05 Auto Reversal' AND :NEW.DEAL_TYPE = '7.05 Exception - Indirect' AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.ADJUSTMENT_TYPE := 'Rev Adj';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := -:NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;  
    
    -- Payment Application
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Payment application' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Payment application' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard'  AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Payment application' AND :NEW.DEAL_TYPE = '7.05 Exception' THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ADJUSTMENT_TYPE := 'Application';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF  :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Payment application' AND :NEW.DEAL_TYPE = '7.05 Exception - Indirect' THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ADJUSTMENT_TYPE := 'Application';
      :NEW.TRADE_AR := null;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Payment application' AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := :NEW.ADJUSTMENT_AMT;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM297" := null;
    
    -- Move AR to GL
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard'  AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR to GL' AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := - :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := :NEW.ADJUSTMENT_AMT;

    -- Move AR from GL
    ELSIF  :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard' AND INSTR(UPPER(:NEW.ASSIGNEE), 'CLOUD') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;
    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND :NEW.DEAL_TYPE = 'Upfront billing / 7.05 Standard'  AND INSTR(UPPER(:NEW.ASSIGNEE), 'WAREHOUSE') > 0 THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM232" := null;
      :NEW."OFD_WHV2_XM297" := null;

    ELSIF :NEW.SOURCE = 'Oracle' AND :NEW.MOVEMENT_TYPE = 'Move AR from GL' AND :NEW.DEAL_TYPE = 'Warehouse V2' THEN 
      :NEW.PAYMENT_APPLIED_TO_INVOICE := null;
      :NEW.ADJUSTMENT_TYPE := 'AR Adjustment';
      :NEW.TRADE_AR := :NEW.ADJUSTMENT_AMT;
      :NEW.UNBILLED := null;
      :NEW."AR_AP_NETTING" := null;
      :NEW."OFD_CLD_120604" := null;
      :NEW."OFD_WH_120804" := null;
      :NEW."OFD_WHV2_XM232" := - :NEW.ADJUSTMENT_AMT;
      :NEW."OFD_WHV2_XM297" := null;
        
    END IF;

 END;
/
ALTER TRIGGER "AdjRep_TRIGGER" ENABLE;